<!DOCTYPE html>
<html>

<head>
    <title>Read A SpreadSheet located in Google</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script lang="javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.12.4/xlsx.core.min.js"></script>

</head>

<body>
    <script>
        function ShowData(table) {

            dt = document.getElementById("my_file_output");
            for (var j = 0; j < table.length; ++j) {

                ele = table[j];
                dt.insertAdjacentHTML('beforeend', ele["id"] + ' - ' + ele["name"] + ': ' + ele["phone"] + '<br>');
            }
        }

        /* set up XMLHttpRequest */
        // url to a public read permission file
        var url = "https://docs.google.com/spreadsheets/d/1PxUconzzhKbvW86TaJv0CJ1Pgvzsc1GYm6AANiJMRKQ/export?type=xlsx";

        var oReq = new XMLHttpRequest();
        oReq.open("GET", url, true);
        oReq.responseType = "arraybuffer";

        oReq.onload = function (e) {
            var arraybuffer = oReq.response;

            /* convert data to binary string */
            var data = new Uint8Array(arraybuffer);

            var arr = new Array();
            for (var i = 0; i != data.length; ++i) {
                arr[i] = String.fromCharCode(data[i]);
            }

            var bstr = arr.join("");
            var cfb = XLSX.read(bstr, { type: 'binary' });
            var sh = cfb.Sheets[cfb.SheetNames[0]];
            var table = XLSX.utils.sheet_to_json(sh);

            ShowData(table);
        }


        oReq.send();
    </script>

    <h4>Danh sách tài khoản</h4>
    <div id="my_file_output">
    </div>
</body>

</html>